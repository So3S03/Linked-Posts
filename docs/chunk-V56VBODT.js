import{a as J}from"./chunk-PP3QN6IV.js";import{Ga as N,Ja as l,V as S,Wb as G,Xa as u,Y as B,Za as m,Zb as q,ab as p,d as K,eb as t,fb as e,fc as Q,ga as _,gb as s,gc as P,ha as C,hb as F,hc as R,ib as w,ic as j,jb as V,jc as Y,kc as I,mb as y,mc as z,nb as E,ob as x,oc as $,pb as n,pc as Z,sa as O,sc as H,uc as W,wb as k,yb as D,zb as U}from"./chunk-KODTIHXY.js";var g=K(W());var X=["changePassClsBtn"],ee=["uploadPhotoClsBtn"];function te(o,c){o&1&&(t(0,"p",33),n(1,"This field is requierd"),e())}function ie(o,c){o&1&&(t(0,"p",44),n(1,"This Field is required"),e())}function ne(o,c){o&1&&(t(0,"p",45),n(1,"You should follow this pattern"),e(),t(2,"p"),n(3,"1. must have at least one sympole"),e(),t(4,"p"),n(5,"2. must be at least 8 characters"),e(),t(6,"p"),n(7,"3. must have at least one upper char"),e(),t(8,"p"),n(9,"4. must have at least one lower char"),e(),t(10,"p"),n(11,"5. must have at least one number"),e())}function oe(o,c){if(o&1&&(t(0,"div",33),u(1,ie,2,0,"p",44)(2,ne,12,0),e()),o&2){let a,r,i=V();l(),p(1,(a=i.changePasswordData.get("newPassword"))!=null&&a.getError("required")?1:-1),l(),p(2,(r=i.changePasswordData.get("newPassword"))!=null&&r.getError("pattern")?2:-1)}}function ae(o,c){o&1&&s(0,"i",39)}function le(o,c){o&1&&s(0,"i",39)}var ge=(()=>{class o{constructor(){this._PLATFORM_ID=S(O),this._AuthenticationService=S(J),this.isChangePassLoad=!1,this.isUploadPhotoLoad=!1,this.changePasswordData=new Y({password:new I(null,[P.required]),newPassword:new I(null,[P.required,P.pattern(/^(?=.*[!@#$%&*])(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}$/)])})}changeImage(a){this.ImageInput=a.target,this.ImageInput.files&&this.ImageInput.files.length>0&&(this.SavedImage=this.ImageInput.files[0])}UploadPhoto(){this.isUploadPhotoLoad=!0;let a=null;this.SavedImage&&(a=new FormData,a.append("photo",this.SavedImage)),a!==null&&this._AuthenticationService.uploadProfilePhoto(a).subscribe({next:r=>{this.isUploadPhotoLoad=!1,console.log(r),g.default.fire({title:"Success!",text:"Your Photo is uploaded successfuly!",icon:"success"}),this.uploadPhotoCloseBtn.nativeElement.click()},error:r=>{this.isUploadPhotoLoad=!1,console.log(r),g.default.fire({icon:"error",title:"Oops...",text:"Something went wrong while adding this photo !"})}})}changePasswordSubmition(){this.changePasswordData.valid&&(this.isChangePassLoad=!0,this._AuthenticationService.changePassword(this.changePasswordData.value).subscribe({next:a=>{q(this._PLATFORM_ID)&&localStorage.setItem("socialToken",a.token),console.log(a.token),g.default.fire({title:"Success!",text:"Your password has been changed successfuly!",icon:"success"}),this.isChangePassLoad=!1,this.changePassCloseBtn.nativeElement.click()},error:a=>{console.log(a),g.default.fire({icon:"error",title:"Oops...",text:"Something went wrong!"}),this.isChangePassLoad=!1}}))}ngOnDestroy(){this.isChangePassLoad=!1,this.isUploadPhotoLoad=!1}static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275cmp=B({type:o,selectors:[["app-user-settings"]],viewQuery:function(r,i){if(r&1&&(y(X,5),y(ee,5)),r&2){let d;E(d=x())&&(i.changePassCloseBtn=d.first),E(d=x())&&(i.uploadPhotoCloseBtn=d.first)}},standalone:!0,features:[k],decls:82,vars:18,consts:[["changePassClsBtn",""],["uploadPhotoClsBtn",""],[1,"pt-5","setting-section"],[1,"w-40","mx-auto","rounded-4","position-relative","border","custom-padding","px-3","bg-sec-color"],[1,"settings-Photo","bg-body"],["alt","",1,"w-100","rounded-circle","object-fit-cover","h-100",3,"src"],[1,"row","justify-content-between"],[1,"col-md-6","mb-3"],["for","NameControl",1,"form-label"],["type","text","id","NameControl","disabled","","readonly","",1,"form-control",3,"value"],["for","GenderControl",1,"form-label"],["type","text","id","GenderControl","disabled","","readonly","",1,"form-control",3,"value"],[1,"col-md-12","mb-3"],["for","EmailControl",1,"form-label"],["type","email","id","EmailControl","disabled","","readonly","",1,"form-control",3,"value"],["for","BirthDateControl",1,"form-label"],["type","text","id","BirthDateControl","disabled","","readonly","",1,"form-control",3,"value"],["for","CreateDateControl",1,"form-label"],["type","text","id","CreateDateControl","disabled","","readonly","",1,"form-control",3,"value"],["for","UserIdControl",1,"form-label"],["type","text","id","UserIdControl","disabled","","readonly","",1,"form-control",3,"value"],["data-bs-toggle","modal","data-bs-target","#ChangePasswordModal",1,"w-100","btn","btn-primary"],["data-bs-toggle","modal","data-bs-target","#UploadPhotoModal",1,"w-100","btn","btn-primary"],["id","ChangePasswordModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[3,"ngSubmit","formGroup"],["for","OldPasswordControl",1,"form-label"],["type","text","id","OldPasswordControl","formControlName","password",1,"form-control"],[1,"alert","alert-danger"],["for","NewPasswordControl",1,"form-label"],["type","text","id","NewPasswordControl","formControlName","newPassword",1,"form-control"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"fa-solid","fa-spinner","fa-spin"],["id","UploadPhotoModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["for","UploadPhotoControl",1,"form-label"],["type","file","id","UploadPhotoControl",1,"form-control",3,"change"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"m-0"],[1,"fw-bold"]],template:function(r,i){if(r&1){let d=F();t(0,"section",2)(1,"div",3)(2,"div",4),s(3,"img",5),e(),t(4,"div",6)(5,"div",7)(6,"label",8),n(7,"User Name"),e(),s(8,"input",9),e(),t(9,"div",7)(10,"label",10),n(11,"User Gender"),e(),s(12,"input",11),e(),t(13,"div",12)(14,"label",13),n(15,"User Email"),e(),s(16,"input",14),e(),t(17,"div",7)(18,"label",15),n(19,"Date Of Birth"),e(),s(20,"input",16),D(21,"date"),e(),t(22,"div",7)(23,"label",17),n(24,"Date of Creation"),e(),s(25,"input",18),D(26,"date"),e(),t(27,"div",12)(28,"label",19),n(29,"User ID"),e(),s(30,"input",20),e(),t(31,"div",7)(32,"button",21),n(33,"Change Password"),e()(),t(34,"div",7)(35,"button",22),n(36,"Change Profile Photo"),e()()()()(),t(37,"div",23)(38,"div",24)(39,"div",25)(40,"div",26)(41,"h1",27),n(42,"Change Password"),e(),s(43,"button",28),e(),t(44,"div",29)(45,"form",30),w("ngSubmit",function(){return _(d),C(i.changePasswordSubmition())}),t(46,"div",12)(47,"label",31),n(48,"Old Password"),e(),s(49,"input",32),u(50,te,2,0,"p",33),e(),t(51,"div",12)(52,"label",34),n(53,"New Password"),e(),s(54,"input",35),u(55,oe,3,2,"div",33),e()()(),t(56,"div",36)(57,"button",37,0),n(59,"Close"),e(),t(60,"button",38),n(61,"Save changes "),u(62,ae,1,0,"i",39),e()()()()(),t(63,"div",40)(64,"div",24)(65,"div",25)(66,"div",26)(67,"h1",27),n(68,"Upload Profile Photo"),e(),s(69,"button",28),e(),t(70,"div",29)(71,"div",12)(72,"label",41),n(73,"Upload Photo"),e(),t(74,"input",42),w("change",function(f){return _(d),C(i.changeImage(f))}),e()()(),t(75,"div",36)(76,"button",37,1),n(78,"Close"),e(),t(79,"button",43),w("click",function(){return _(d),C(i.UploadPhoto())}),n(80,"Upload "),u(81,le,1,0,"i",39),e()()()()()}if(r&2){let d,h,f,L,A,M,T,b,v;l(3),m("src",(d=i._AuthenticationService.userData())==null?null:d.photo,N),l(5),m("value",(h=i._AuthenticationService.userData())==null?null:h.name),l(4),m("value",(f=i._AuthenticationService.userData())==null?null:f.gender),l(4),m("value",(L=i._AuthenticationService.userData())==null?null:L.email),l(4),m("value",U(21,14,(A=i._AuthenticationService.userData())==null?null:A.dateOfBirth)),l(5),m("value",U(26,16,(M=i._AuthenticationService.userData())==null?null:M.createdAt)),l(5),m("value",(T=i._AuthenticationService.userData())==null?null:T._id),l(15),m("formGroup",i.changePasswordData),l(5),p(50,(b=i.changePasswordData.get("password"))!=null&&b.errors&&((b=i.changePasswordData.get("password"))!=null&&b.touched)?50:-1),l(5),p(55,(v=i.changePasswordData.get("newPassword"))!=null&&v.errors&&((v=i.changePasswordData.get("newPassword"))!=null&&v.touched)?55:-1),l(5),m("disabled",i.changePasswordData.invalid||i.isChangePassLoad),l(2),p(62,i.isChangePassLoad?62:-1),l(17),m("disabled",!i.SavedImage||i.isUploadPhotoLoad),l(2),p(81,i.isUploadPhotoLoad?81:-1)}},dependencies:[G,H,z,Q,R,j,$,Z],styles:[".setting-section[_ngcontent-%COMP%]{margin-top:7%}.custom-padding[_ngcontent-%COMP%]{padding-top:130px}.settings-Photo[_ngcontent-%COMP%]{position:absolute;width:150px;height:150px;border-radius:50%;border:3px solid gray;left:37%;top:-10%!important}"]})}}return o})();export{ge as UserSettingsComponent};
